%!TEX TS-program = XeLaTeX
%!TEX encoding = UTF-8 Unicode

\documentclass[twoside]{article}

% make twoside setting into a more convenient conditional
\newif\ifduplex
\makeatletter
  \if@twoside\duplextrue\fi
\makeatother

\usepackage{fontspec,xltxtra}
\setmainfont[Ligatures=TeX]{Minion Pro}
\setsansfont[Ligatures=TeX,Scale=MatchLowercase]{Scala Sans Pro}
\setmonofont[Scale=MatchLowercase]{Menlo}
\frenchspacing

% Two known solutions, via Marco Daniel and Kevin Godby: <http://tex.stackexchange.com/questions/34368/>.
% The `fullwidth` / `mdframed` packages work great with text, but cannot be wrapped around images
% and figures, which is how I'd like to use it with pandoc. Therefore, the Tufte-LaTeX route was preferred.

\usepackage[strict]{changepage}% provides the adjustwidth environment
\usepackage{multicol}% for multiple columns inside the fullwidth environment
\usepackage{lipsum}

% The following code should be used *after* any changes to the margins and
% page layout are made (e.g., after the geometry package has been loaded).
\newlength{\overhang}
  \setlength{\overhang}{\marginparwidth}
  \addtolength{\overhang}{\marginparsep}
\newlength{\fullmeasure}
  \setlength{\fullmeasure}{\textwidth}
  \addtolength{\fullmeasure}{\overhang}

\newenvironment{fullwidth}{%
  \begin{adjustwidth\ifduplex*\fi}{}{-\overhang}}{%
  \end{adjustwidth\ifduplex*\fi}}

\usepackage[font={footnotesize,sf},labelfont=bf,labelsep=period]{caption}
\usepackage{floatrow}% make use of full width with tables and figures

\captionsetup[capbesidefloat]{justification=raggedright,singlelinecheck=false}
\DeclareMarginSet{outside}{\ifduplex\setfloatmargins*{}{\hskip-\overhang}\fi}
\DeclareFloatSeparators{marginparsep}{\hskip\marginparsep}
\floatsetup[figure]{margins=outside,floatwidth=\textwidth,%
  capposition=beside,capbesideposition={top,outside},\ifduplex facing=yes,\fi,%
  capbesidewidth=\marginparwidth,capbesidesep=marginparsep}

% facing=yes or no needs to be set manually, checking for two side
% perhaps I should extract this as a variable

\usepackage{showframe}

\title{Brief Article}
\author{The Author}
%\date{}

\begin{document}
\maketitle

\lipsum[1]

\begin{fullwidth}
  \begin{multicols}{2}
    \lipsum[2]
  \end{multicols}
  \begin{figure}[htbp]
    \centering
    \includegraphics{./logo.png}
    \caption{An image and a caption}
  \end{figure}
\end{fullwidth}

\lipsum[3-4]

\begin{fullwidth}
  \lipsum[5]
  \begin{figure}[htbp]
    \centering
    \includegraphics{./logo.png}
    \caption{An image and a caption with rather longer text, requiring another line break or two in \LaTeX}
  \end{figure}
  \begin{multicols}{2}
    \lipsum[6]
  \end{multicols}
\end{fullwidth}

\lipsum[7]

\end{document}